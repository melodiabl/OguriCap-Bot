services:
  whatsapp-bot:
    build:
      context: .
    container_name: whatsapp-bot
    restart: always
    stdin_open: true
    tty: true
    volumes:
      - ./Sessions:/usr/src/app/Sessions
    expose:
      - "3001"
    environment:
      NODE_ENV: production
      PORT: 3001

  admin-panel:
    build:
      context: ./frontend-next
    container_name: admin-panel
    restart: always
    expose:
      - "3000"
    environment:
      NODE_ENV: production
      NEXT_PUBLIC_API_URL: ""

  nginx:
    image: nginx:alpine
    container_name: konmi-nginx
    restart: always
    depends_on:
      - admin-panel
      - whatsapp-bot
    ports:
      - "80:80"
    volumes:
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
